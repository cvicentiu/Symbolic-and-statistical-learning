function AdManager(){this.oEM=null;this.oAM=null;this.ver=1.0;this.chooseProductSet=$a;this.getSlot=$b;this.isSlotAvailable=$c;this.renderSlot=$d;this.renderHeader=$e;this.renderFooter=$f;this.getParam=$g;this.setParam=$h;this.setForcedParam=$i;this.setHostId=$j;this.setTaxId=$k;this.setVid=$l;this.supportProductSet=$m;this.setDebugMode=$o;this.init=$n;this.opCon=$p;this.init();};function $a(){if(window.cmbad)return;var $06=new ProgramManager(this.oEM);this.oAM=$06.run();return this.oAM.PsName;};function $b($07){if(window.cmbad)return "";return this.oAM.getSlot($07);};function $c($08){if(window.cmbad)return false;return this.oAM.avail($08);};function $d($07){if(window.cmbad)return;document.write(this.oAM.getSlot($07));};function $e(){if(window.cmbad)return;document.write(this.oAM.getSlot("header"));};function $f(){if(window.cmbad)return;document.write(this.oAM.getSlot("footer"));this.oEM.dbg();};function $g($09){return this.oEM.getParam($09);};function $h($09,$0a){if(window.cmbad)return;$09="user."+$09;this.oEM.setParam($09,$0a);};function $i($09,$0a){if(window.cmbad)return;this.oEM.setParam($09,$0a);};function $j($0b){return;};function $k($0c){return;};function $l($0d){return;};function $m($0e){return;};function $n(){CmSetErr();this.oEM=new EnvironmentManager();var oB=new BrowserDetector();this.oEM.setParam("system.browser.name",oB.type);this.oEM.setParam("system.browser.vers",oB.version);this.oEM.setParam("system.browser.os",oB.os);this.oEM.setParam("system.ordinal",CmOrd());CmNsFix();this.setDebugMode(this.oEM.getIntParam("cmdebug",0));};function $o($0f){window.cmDebugLevel=($0f)?$0f:0;if($0f){this.opCon();}};function $p(){window.dbgWin=window.open("","cmConsole");CmDebug(0,"Ad Manager","Init","",new Array("Location",document.URL,"Version",this.ver));};function AdSetManager(){this.PsName="";this.psId="0";this.bcn=new Array();this.out=new Array();this.oTP=new AdTagProcessor();this.avail=$q;this.getSlot=$r;this.add=$s;this.process=$u;this.setPs=$v;this.agg=$t;};function $q($07){if(CmNull(this.out[$07]))return false;return true;};function $r($07){var $0g="";if($07=="header"){$0g=this.agg("HEADER");}else if($07=="footer"){$0g=this.agg("FOOTER");}else{if(!(CmNull(this.out[$07]))){var $0h=this.out[$07];if(!(CmNull($0h["BODY"]))){var $0i=$0h["BODY"];$0g=$0i["html"];}}};CmDebug(0,"Ad Set Manager","Get Slot",$0g,new Array("Product Set",this.PsName,"Slot",$07));return $0g;};function $s($07,$0j,$0k,$0l,$0m,$0n){CmDebug(3,"Ad Set Manager","Add Template",$0k,new Array("Product Set Id",$0l,"Uap Id",$0m,"Engine Id",$0n,"Slot",$07,"Position",$0j));this.bcn[this.bcn.length]=$0l+","+$0m+","+$0n;if(CmNull(this.out[$07])){this.out[$07]=new Array();};var $0o=this.out[$07];if(CmNull($0o[$0j])){$0o[$0j]=new Array();var $0i=$0o[$0j];$0i["template"]="";};var $0p=$0o[$0j];$0p["template"]+=$0k;};function $t($08){var $0q="";for(var $0r in this.out){var $0h=this.out[$0r];if(CmNull($0h))continue;var $0s=$0h[$08];if(CmNull($0s))continue;$0q+=$0s["html"]+"\n";};return $0q;};function $u($0t){var $0u=0;var $0v=0;$0t.setParam("system.cm_pset",this.psId);$0t.setParam("system.cm_products",this.bcn.join(";"));this.oTP.load($0t);for(var $0w in this.out){var $0h=this.out[$0w];if(CmNull($0h))continue;var $0x=""+($0v+1);$0t.setParam("system.prodseq",$0x);$0t.setParam("system.pos",$0x);$0t.setParam("system.tile",$0x);for(var $0y in $0h){var $0i=$0h[$0y];if(CmNull($0i))continue;var $0z=$0i["template"];this.oTP.setTemplate($0z);var $0A=this.oTP.process();$0i["html"]=$0A;};$0v++;}};function $v($0B,$0l){this.PsName=$0B;this.psId=$0l;};function AdTagProcessor(){this.str="";this.oEM;this.esT;this.dlT;this.opT;this.cpT;this.deT;this.init=$w;this.load=$x;this.setTemplate=$y;this.process=$z;this.ts=$A;this.init();};function $w(){this.esT=new Array(10,12,11,10,11,12,12,10,12,11,0,4,12);this.dlT=new Array(6,7,8,12,8,9,7,0,9,4,0,4,12);this.opT=new Array(2,12,12,2,12,12,12,12,12,12,0,4,12);this.cpT=new Array(12,12,3,12,3,12,12,3,12,3,0,4,12);this.deT=new Array(0,1,4,0,4,5,1,0,5,4,0,4,12);};function $x($0C){this.oEM=$0C;};function $y($0D){this.str=($0D)?$0D:"";CmDebug(5,"Ad Tag Processor","Set Template",this.str,null);};function $z(){var $0D=this.str;var $0E=0;var $0F=new Array();var $0G=0;var $0H="";var $0I="";var $0J="";var $0K=new Array();$0K[0]="";$0K[1]="";var $0L=0;var $0M=$0D.length;for(var i=0;i<$0M;i++){var c=$0D.charAt(i);$0E=this.ts($0E,c);if($0E==12){var $0N="<!-- Undefined State Encountered at Character "+c+" -->";CmDebug(5,"Ad Tag Processor","Processed Template",$0N,null);return $0N;};if($0E==0){$0F[$0G++]=c;continue;};if($0E==1){$0J+=c;continue;};if($0E==3){var $0O=$0K[0];var $0P=$0K[1];$0H=$0H.toLowerCase();var $0Q=this.oEM.getParam($0H);if($0Q){var $0R=$0Q.length;for(var k=0;k<$0R;k++){if($0Q[k]!=""){$0F[$0G++]=$0O+$0Q[k]+$0P;}}};$0K[0]="";$0K[1]="";$0H="";$0L=0;continue;};if($0E==4){$0K[$0L]+=c;continue;};if($0E==5){$0H+=c;continue;};if($0E==7){$0J=$0J.toLowerCase();$0F[$0G++]=this.oEM.getStringParam($0J,"");$0J="";continue;};if($0E==8){$0L++;$0F[$0G++]=$0I;$0I="";continue;}};var $0N=$0F.join("");CmDebug(5,"Ad Tag Processor","Processed Template",$0N,null);return $0N;};function $A($0S,c){if($0S<0||$0S>12)return 12;if(c=='\\')return this.esT[$0S];if(c=='$')return this.dlT[$0S];if(c=='(')return this.opT[$0S];if(c==')')return this.cpT[$0S];return this.deT[$0S];};function BrowserDetector(){this.type;this.os;this.version;this.find=$C;this.init=$B;this.init();};function $B(){var $0T=String(navigator.userAgent).toLowerCase();var $0s=new Array("konqueror","opera","webtv","icab","aol","msie");var $0U=this.find($0T,$0s);if(($0U=="undefined")&&($0T.indexOf("compatible")==-1)){$0U="netscape";};var $0V=new Array("linux","x11","mac","win","konqueror");var $0W=this.find($0T,$0V);if($0W=="konqueror"){$0W="linux";};this.os=$0W;var $0X="";var $0Y=8;if($0U!="netscape"){$0Y=$0T.indexOf($0U)+1+$0U.length;};for(var i=$0Y;(i<$0T.length)&&($0T.charAt(i)!=' ')&&($0T.charAt(i)!=';');i++){$0X+=$0T.charAt(i);};this.version=$0X;if($0U=="msie"){$0U="ie";};if($0U=="netscape"){$0U="ns";};this.type=$0U;};function $C($0T,$0Z){for(var i=0;i<$0Z.length;i++){if($0T.indexOf($0Z[i])!=-1){return $0Z[i];}};return "undefined";};function EnvironmentManager(){this.cache=new Array();this.coll=new Array();this.getParam=$G;this.getIntParam=$H;this.getStringParam=$I;this.setParam=$J;this.init=$D;this.parse=$E;this.split=$F;this.concat=$L;this.lookup=$K;this.all=$M;this.add=$N;this.dbg=$O;this.init();};function $D(){var $10=this.coll;var $11=new Array("user","system","default","cgi","form");for(var i=0;i<$11.length;i++){var j=$11[i];$10[j]=new Array();};$10["cookie"]=this.parse("cookie");$10["query"]=this.parse("query");$10["referer"]=this.parse("referer");};function $E($12){var $0s=new Array();if(($12=="cookie")&&!(CmNull(document.cookie))){var $13=String(document.cookie);var $14=$13.split("; ");for(var i=0;i<$14.length;i++){var $15=$14[i].indexOf("=");if($15!=-1){var $16=$14[i].substring(0,$15);var $17=$14[i].substring($15+1);var $18=$17.split("&");for(var j=0;j<$18.length;j++){var $19=$18[j].indexOf("=");if($19!=-1){var $1a=$18[j].substring(0,$19);var $1b=$18[j].substring($19+1);CmAdd($0s,$16+"."+$1a,$1b);}else{CmAdd($0s,$16,$18[j]);}}}};return $0s;};var $1c="";if(($12=="referer")&&!(CmNull(document.referrer))){$1c=String(document.referrer);};if($12=="query"){if(document.all){$1c=String(document.URL);}else{$1c=(document.location)?String(document.location.search):"";}};if($1c!=""){var $1d=$1c.split("?");if($1d.length>1){var $1e=$1d[1].split("&");if($1e.length){for(var i=0;i<$1e.length;i++){var $1f=$1e[i].split("=");var $0r=$1f[0];var $1g=($1f[1])?$1f[1]:null;CmAdd($0s,$0r,$1g);}}};return $0s;};return $0s;};function $F($0r){var $0s=new Array();var $1h=$0r.indexOf(".");if($1h!=-1){$0s["scope"]=$0r.substring(0,$1h);$0s["name"]=$0r.substring($1h+1,$0r.length);}else{$0s["scope"]=$0r;$0s["name"]=$0r;};return $0s;};function $G($0r){$0r=$0r.toLowerCase();if(typeof(this.cache[$0r])!="undefined"){return this.cache[$0r];};this.cache[$0r]=this.lookup($0r);return this.cache[$0r];};function $H($09,$1i){var $1j=$1i;var $1k=this.getParam($09);if($1k&&$1k.length){if(!(isNaN($1k[$1k.length-1]))){$1j=parseInt($1k[$1k.length-1]);}};return $1j;};function $I($09,$1l){var $1m=$1l;var $1k=this.getParam($09);if($1k&&$1k.length)return $1k[$1k.length-1];return $1m;};function $J($09,$0a){this.add($09,$0a);this.cache[$09]=void 0;};function $K($09){var $0s=this.split($09);var $1n=$0s["scope"];var name=$0s["name"];var $11=this.coll[$1n];if(!(CmNull($11))){return($11[name])?$11[name]:null;}else{return this.all($09);}};function $L($1o,$1p){if($1p){for(var i=0;i<$1p.length;i++){$1o[$1o.length]=$1p[i];}}};function $M($09){var $1q=new Array();for(var name in this.coll){var $1r=this.coll[name];var $0s=$1r[$09];this.concat($1q,$0s);};return($1q.length>0)?$1q:null;};function $N($09,$0a){$09=$09.toLowerCase();var $0s=this.split($09);var $1n=$0s["scope"];var name=$0s["name"];var $11=this.coll[$1n];if(!(CmNull($11))){CmAdd($11,name,$0a);}else{CmAdd(this.coll["default"],name,$0a);};this.cache[name]=void 0;return;};function $O(){var $1s=new Array();for(var $09 in this.cache){var $1k=this.cache[$09];if(typeof($1k)=="undefined")continue;if(CmNull($1k)){$1s[$1s.length]=$09;$1s[$1s.length]="Null";}else{for(var i=0;i<$1k.length;i++){$1s[$1s.length]=$09;$1s[$1s.length]=$1k[i];}}};CmDebug(0,"Env Manager","Cache","",$1s);};function DataSetManager(){this.arrPs=new Array();this.lPs=new Array();this.add=$P;this.getPsName=$Q;this.getSlotName=$R;this.getTemplate=$S;};function $P($1t,$1u,$1v,$1w,$1x,$1y,$1z,$1A,$1B){CmDebug(7,"Data Set Manager","Add Template",$1t,new Array("Product Set Id",$1u,"Product Set Name",$1v,"Uap Id",$1w,"Slot",$1x,"Engine Id",$1y,"Browser Name",$1z,"Browser Version",$1A,"Position",$1B));if(!(this.arrPs[$1u])){this.arrPs[$1u]=new ProductSet();this.lPs[$1u]=$1v;};this.arrPs[$1u].add($1t,$1w,$1x,$1y,$1z,$1A,$1B);};function $Q($1u){return this.lPs[$1u];};function $R($1u,$1w){var ps=this.arrPs[$1u];if(!(ps)){return "";};return ps.getSlotName($1w);};function $S($1u,$1w,$1y,$1z,$1A,$1B){var ps=this.arrPs[$1u];if(!(ps)){return "";};return ps.get($1w,$1y,$1z,$1A,$1B);};function BrowserType(){this.arrVer=new Array();this.lVer=new Array();this.cnt=0;this.add=$T;this.get=$U;this.sel=$V;};function $T($1t,$1A,$1B){if(!(this.arrVer[$1A])){this.lVer[this.cnt++]=$1A;this.arrVer[$1A]=new BrowserVersion();};this.arrVer[$1A].add($1t,$1B);};function $U($1A,$1B){var $1C=this.sel($1A);if(!($1C)){return "VNF";};var $1D=this.arrVer[$1C];if(!($1D)){return "VNF";};return $1D.get($1B);};function $V($1E){var $1F=parseFloat($1E);for(var i=0;i<this.cnt;i++){var $1G=parseFloat(this.lVer[i]);if($1F>=$1G){return this.lVer[i];}};return null;};function BrowserVersion(){this.arrPos=new Array();this.add=$W;this.get=$X;};function $W($1t,$1B){this.arrPos[$1B]=$1t;};function $X($1B){var $1t=this.arrPos[$1B];return(($1t)?$1t:"");};function Engine(){this.arrBr=new Array();this.add=$Y;this.get=$Z;this.def=$00;};function $Y($1t,$1z,$1A,$1B){if(!(this.arrBr[$1z])){this.arrBr[$1z]=new BrowserType();};this.arrBr[$1z].add($1t,$1A,$1B);};function $Z($1z,$1A,$1B){var $1H=this.arrBr[$1z];if(!($1H)){return this.def($1B);};var $1I=$1H.get($1A,$1B);if($1I=="VNF"){return this.def($1B);};return $1I;};function $00($1B){var $1H=this.arrBr["default"];if(!($1H)){return "";};var $1I=$1H.get("0",$1B);if($1I==null||$1I=="VNF"){return "";};return $1I;};function ProductSet(){this.arrUaps=new Array();this.lUap=new Array();this.add=$01;this.getSlotName=$02;this.get=$03;};function $01($1t,$1w,$1x,$1y,$1z,$1A,$1B){if(!(this.arrUaps[$1w])){this.arrUaps[$1w]=new Uap();this.lUap[$1w]=$1x;};this.arrUaps[$1w].add($1t,$1y,$1z,$1A,$1B);};function $02($1w){return this.lUap[$1w];};function $03($1w,$1y,$1z,$1A,$1B){var $1J=this.arrUaps[$1w];if(!($1J)){return "";};return $1J.get($1y,$1z,$1A,$1B);};function Uap(){this.arrEng=new Array();this.add=$04;this.get=$05;};function $04($1t,$1y,$1z,$1A,$1B){if(!(this.arrEng[$1y])){this.arrEng[$1y]=new Engine();};this.arrEng[$1y].add($1t,$1z,$1A,$1B);};function $05($1y,$1z,$1A,$1B){var $1K=this.arrEng[$1y];if(!($1K)){return "";};return $1K.get($1z,$1A,$1B);};function CmNull($1L){if(typeof($1L)=="undefined"||$1L==null)return true;return false;};function CmResize(){if(window.cmsiw<window.innerWidth||window.cmsiw>window.innerWidth||window.cmsih>window.innerHeight||window.cmsih<window.innerHeight){window.history.go(0);}};function CmNsFix(){if(document.layers){if(!window.cmsiw){window.onresize=CmResize;window.cmsiw=window.innerWidth;window.cmsih=window.innerHeight;}}};function CmOrd(){var $1M=0;var i=0;var $1N="";var $1O=""+CmRand(0,100);while($1M<7&&i<$1O.length){var c=$1O.charAt(i);if(!(isNaN(c))){$1N+=c;$1M++;};i++;};return $1N;};function CmRand($1P,$1Q){return(Math.random()*($1Q-$1P))+$1P;};function getCkVal(_o){var ck=document.cookie;var es=ck.indexOf(";",_o);if(es==-1)es=document.cookie.length;return unescape(ck.substring(_o,es));};function GetCookie(name){var ck=document.cookie;if((ck==null)||(ck.length==null)){return null;};var $1R=name+"=";var $1S=$1R.length;var i=0;while(i<ck.length){var j=i+$1S;if(ck.substring(i,j)==$1R)return getCkVal(j);i=ck.indexOf(" ",i)+1;if(i==0)break;};return null;};function CookieWrapper($1T,$1U,$1V,$1W,$1X,$1Y,$1Z){this.expiration=$1X;this.name=$1T;this.value=$1U;this.key=$1V;this.domain=$1W;this.ttl=$1X;if($1X!=null){var $20=new Date($1X);this.ttl=$20.toGMTString();};this.path=$1Y;this.secure=$1Z;};function cmSetSimpleCookie($21){var $22=$21.name+"="+$21.value;$22+=(($21.ttl==null)?"":("; expires="+$21.ttl));$22+=(($21.path==null)?"; path=/":("; path="+$21.path));$22+=(($21.domain==null)?"":("; domain="+$21.domain));$22+=(($21.secure==true)?"; secure":"");document.cookie=$22;};function CmSetCookie($1T,$1V,$1U,$1X,$1W,$1Y,$1Z){var $23=new CookieWrapper($1T,$1U,$1V,$1W,$1X,$1Y,$1Z);if($23.key){var $24=String(document.cookie);if($24.indexOf($1T+"=")!=-1){cmUpdateDictionary($23);}else{$23.value=$23.key+"="+$23.value+"&";}};cmSetSimpleCookie($23);CmDebug(0,"Rules Manager","Set Cookie",$1T,new Array("Name",$1T,"Key",$1V,"Value",$1U,"Expiration",$1X,"Domain",$1W,"Path",$1Y));};function cmUpdateDictionary($23){var $25=GetCookie($23.name);var $26="/([&|=]|^)"+$23.key+"=[^&]*/";if($25.match(eval($26))!=null){$23.value=$25.replace(eval($26),"$1"+$23.key+"="+$23.value);}else{$23.value=$23.key+"="+$23.value+"&"+$25;}};function ucase($0D){if($0D!=null){return $0D.toUpperCase();};return "";};function lcase($0D){if($0D!=null){return $0D.toLowerCase();};return "";};function urlencode($0D){if($0D!=null){return escape($0D);};return "";};function contains($0D,$1L){if(($0D!=null)&&($1L!=null)){if($0D.indexOf($1L)!=-1){return true;}};return false;};function CmTrace(){var s="";for(var a=arguments.caller;a!=null;a=a.caller){s+="<BR><BR>"+a.callee.toString()+"\n";if(a.caller==a){s+="*";break;}};return s;};function CmOnError($27,$28,$29){if(window.cmDebugLevel){document.write("Error: Message:"+$27+":, Url="+$28+":, Line="+$29+"<BR>");document.write(CmTrace());};if(window.cm_onerror){window.cm_onerror();};window.cmbad=true;return true;};function CmSetErr(){window.cm_onerror=window.onerror;window.onerror=CmOnError;window.cmbad=false;};function CmSetVer($0X){window.cmver=$0X;};function CmAdd($2a,$09,$0a){$09=$09.toLowerCase();if(!($2a[$09])){$2a[$09]=new Array();};var $2b=$2a[$09];$2b[$2b.length]=$0a;};function CmDbg($0D){if(window.dbgWin&&window.dbgWin.open&&!window.dbgWin.closed){window.dbgWin.document.write($0D);}};function CmRow($2c,$2d,$2e,$2f){CmDbg('<tr><td width="180" bgColor="'+$2c+'">'+$2e+'</td><td width="620" bgColor="'+$2d+'">'+$2f+'</td></tr>');};function CmDebug($2g,$2h,$2i,$2j,$0s){if(window.cmDebugLevel<=$2g)return;if(CmNull($0s)&&$2j=="")return;CmDbg('<BR><table width="800" border="1"><tbody>');CmRow("#FF99FF","#FF99FF",$2h,$2i);if(!(CmNull($0s))){for(var i=0;i<$0s.length-1;i=i+2){CmRow("#FFFFCC","#c0c0c0",$0s[i],$0s[i+1]);}};if($2j&&$2j!=""){CmRow("#FFFFCC","#99CCFF","Ad Tag",($2j.replace)?"<PR"+"E>"+$2j.replace(/</g,"&lt;")+"</PR"+"E>":escape($2j));};CmDbg('</tbody></table>');}

