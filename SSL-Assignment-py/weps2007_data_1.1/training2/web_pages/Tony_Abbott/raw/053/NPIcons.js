

// this works for NS version 6 and above.
function drawLockIconNS(anchorname, openedImage, closedImage, curr_date, isSubscriber) {
/*	//set user status.
	var blnIsSubscriber = isSubscriber; 
	//set current date.
	var dteNow = new Date(convert_dates(curr_date));
	for (i = 0 ; i < document.anchors.length ; i ++ ) 
	{		
		if (document.anchors[i].name.toLowerCase() == anchorname.toLowerCase()) {
		
			var dteSwitchoverDate = new Date(convert_dates(document.anchors[i].id));
			
			if (dteSwitchoverDate == "") {
				// do nothing.
			} else if (dteNow >= dteSwitchoverDate) {
				if (blnIsSubscriber == "true") {
					// show opened lock image.					
					document.anchors[i].innerHTML =  document.anchors[i].innerHTML + "<img src='" + openedImage + "' border='0'>";				
				} else {				
					// show closed lock image.								
					document.anchors[i].innerHTML =  document.anchors[i].innerHTML + "<img src='" + closedImage + "' border='0'>";		
					
				}
			} 	


		}
	}
*/
}

// this works for IE version 5 and above.

function drawLockIconIE(anchorname, openedImage, closedImage, curr_date, isSubscriber) {
/*
	//set user status.
	var blnIsSubscriber = isSubscriber;
	//set current date.
	var dteNow = new Date(convert_dates(curr_date));

	if (document.anchors(anchorname)) {

		if (document.anchors(anchorname,0) != null && document.anchors(anchorname,1) == null) 
		{
			// only 1 item found.
			var dteSwitchoverDate = new Date(convert_dates(document.anchors(anchorname,0).id));
			
			if (dteSwitchoverDate == "")
			{
					// do nothing.	
			} else if (dteNow >= dteSwitchoverDate) 
			{		
				if (blnIsSubscriber == "true") {
					// show opened lock image.
					document.anchors(anchorname,0).innerHTML =  document.anchors(anchorname,0).innerHTML + "<img src='" + openedImage + "' border='0'>";				
				} else {
					// show closed lock image.	
					document.anchors(anchorname,0).innerHTML =  document.anchors(anchorname,0).innerHTML + "<img src='" + closedImage + "' border='0'>";		
				}
			}
			
		} else 
		{		
			for (i = 0 ; i < document.anchors(anchorname).length ; i ++ )
			{
			
				//get the switchover date for link.
				var dteSwitchoverDate = new Date(convert_dates(document.anchors(anchorname,i).id));
			
				if (dteSwitchoverDate == "")
				{
					// do nothing.		    
				} else if (dteNow >= dteSwitchoverDate) 
				{		
					if (blnIsSubscriber == "true") {
						// show opened lock image.
						document.anchors(anchorname,i).innerHTML =  document.anchors(anchorname,i).innerHTML + "<img src='" + openedImage + "' border='0'>";				
					} else {
						// show closed lock image.			
						document.anchors(anchorname,i).innerHTML =  document.anchors(anchorname,i).innerHTML + "<img src='" + closedImage + "' border='0'>";		
					}
				}
			}
		}
	}
*/
}

function convert_dates(ddmmyy) {

	var mydate = ddmmyy;
	var delim = new Array(0,0);
	
	for (var i = 0; i < mydate.length; i++ ) {
		if( mydate.charAt(i) == '/') {
			if( delim[0] == 0 ) {
				delim[0] = i;
			} else {
				delim[1] = i;
			}
			
		}
	}
	
	if ( delim[0] == 1 && delim[1] == 4 ) {
		// This is d/mm/yyyy format
		var dd = ddmmyy.substring(0,1);
		var mm = ddmmyy.substring(2,4);
		var yy = ddmmyy.substring(5,mydate.length);		
	} else if ( delim[0] == 2 && delim[1] == 5) {
		// This is dd/mm/yyyy format
		var dd = ddmmyy.substring(0,2);
		var mm = ddmmyy.substring(3,5);
		var yy = ddmmyy.substring(6,mydate.length);
	} else if ( delim[0] == 2 && delim[1] == 4) {
		// This is dd/m/yyyy format	
		var dd = ddmmyy.substring(0,2);
		var mm = ddmmyy.substring(3,4);
		var yy = ddmmyy.substring(5,mydate.length);
	} else if ( delim[0] == 1 && delim[1] == 3) {
		// This is d/m/yyyy format
		var dd = ddmmyy.substring(0,1);
		var mm = ddmmyy.substring(2,3);
		var yy = ddmmyy.substring(4,mydate.length);
	} else {
		// Date format Unknown
		var dd = '';
		var mm = '';
		var yy = '';		
	}
	
	if ( dd == '' || mm == '' || yy == '') {
		// invalid date. return empty string.
		var mmddyy = '';
	} else {
		// return date in mm/dd/yyyy format.
		var mmddyy = mm + '/' + dd + '/' + yy;	
	}
	
	return (mmddyy);
}
